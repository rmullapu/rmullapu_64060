---
title: "Assignment-5"
author: "rama krishna"
date: "11/29/2021"
output:
  word_document: default
  html_document: default
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
```{r}
setwd("C:/Users/krish/OneDrive/Desktop/R_MLCODES/rmullapu_64060")
library(readr)
library(tidyverse)
library(cluster)
library(dplyr)
library(knitr)
library(caret)
library(factoextra)
library(dendextend)
cereals<- read.csv("Cereals.csv")
cereals
```
# To view if the data has any missing values
```{r}
#View(cereals)
```
# To remove the missing values present in the data
```{r}
cdata<- na.omit(cereals)
#view(cdata)
```
#QUESTION 1 Apply hierarchical clustering to the data using Euclidean distance to the normalized measurements. Use Agnes to compare the clustering from single linkage, complete linkage, average linkage, and Ward. Choose the best method.
# Normalize the data
```{r}
cdata_norm <- cbind(cdata[, 1:3], scale(cdata[, -c(1:3)]))
#view(cdata_norm)
```
#Apply hierarchical clustering to the data using Euclidean distance
```{r}
dist <- dist(cdata, method = "euclidean", diag = FALSE, upper = FALSE, p =2)
#dist
```
#clustering the data  and comparing them using agnes
```{r}
single_clust <- agnes(dist, method = "single")
print(single_clust)
# the AGGLOMERATIVE COEFFICIENT using single linkage method is 0.7311616
```
```{r}
complete_clust <- agnes(dist, method = "complete")
print(complete_clust)
#using complete linkage method the AGGLOMERATIVE COEFFICIENT is 0.922957 
```
```{r}
avg_clust <- agnes(dist, method = "average")
print(avg_clust)
#using average linkage method the AGGLOMERATIVE COEFFICIENT is 0.8792621
```
```{r}
ward_clust <- agnes(dist, method = "ward")
print(ward_clust)
#using ward linkage method the AGGLOMERATIVE COEFFICIENT is 0.9597071
```
# by comparing the agglomerative coefficient values ward linkage method is the best method.
```{r}
pltree(ward_clust, cex = 0.6, hang = -1)
rect.hclust(ward_clust, k = 6, border = 1:6)     
Model_1 <- cutree(ward_clust, 6)
data <- cbind(data,Model_1)
```
# QUESTION 3 cluster structure and stability
# Cluster partition A
```{r}
set.seed(123)
dataA_index <- sample(seq_len(nrow(cdata_norm)), size = 67)
dataA <- cdata_norm[dataA_index,]
dataB <- cdata_norm[-dataA_index,]
dataA
```
#Use the cluster centroids from A to assign each record in partition B (each record is assigned to the cluster with the closest centroid).
```{r}
dataA_dist <- dist(dataA[, -c(1:3)], method = "euclidean")
hc_A <- hclust(dataA_dist, method = "ward.D")
Model_A <- cutree(hc_A, 6)
dataA <- cbind(Model_A, dataA)
head(dataA)
C1 <- colMeans(dataA[dataA$Model_A == 1,5:ncol(dataA)])
C2 <- colMeans(dataA[dataA$Model_A == 2,5:ncol(dataA)])
C3 <- colMeans(dataA[dataA$Model_A == 3,5:ncol(dataA)])
C4 <- colMeans(dataA[dataA$Model_A == 4,5:ncol(dataA)])
C5 <- colMeans(dataA[dataA$Model_A == 5,5:ncol(dataA)])
C6 <- colMeans(dataA[dataA$Model_A == 6,5:ncol(dataA)])
Centroids_A <- rbind(C1, C2, C3, C4, C5, C6)
dist <- dist(rbind(Centroids_A,dataB[,4:ncol(dataB)]))
dist
```
#c. Assess how consistent the cluster assignments are compared to the assignments based on all the data.
```{r}
Assignments<- data.frame(data[-dataA_index, "Model_1"])
Assignments$Model_A <- 0
Assignments[1,2] <- which.max(c(2.462441,3.146983,3.782227,5.983747,4.881300,3.826735))
Assignments[2,2] <- which.max(c(2.312626,3.855177, 4.581339, 8.455727 ,4.827885 ,5.441721))
Assignments[3,2] <- which.max(c(3.437484, 1.869957, 4.404072, 8.395433, 4.851045, 4.429787))
Assignments[4,2] <- which.max(c(3.339714, 1.285089 ,4.752289, 8.059830, 4.687570, 3.657016))
Assignments[5,2] <- which.max(c(3.007575 ,3.930439 ,2.431885, 6.230808, 5.027546, 4.008456))
Assignments[6,2] <- which.max(c(3.159701 ,4.694503 ,4.418982, 6.075311, 4.930370, 3.901197))
Assignments[7,2] <- which.max(c(2.691188 ,3.357138, 4.095313, 6.119492, 4.677708, 2.705759))
Assignments
```
#The elementary public schools would like to choose a set of cereals to include in their daily cafeterias. Every day a different cereal is offered, but all cereals should support a healthy diet. For this goal, you are requested to find a cluster of “healthy cereals.” Should the data be normalized? If not, how should they be used in the cluster analysis?
```{r}
healthycereals <- cereals
healthycereals_na <- na.omit(healthycereals)
Clusthealthy <- cbind(healthycereals_na, Model_1)
Clusthealthy[Clusthealthy$Model_1==1,]
Clusthealthy[Clusthealthy$Model_1==2,]
Clusthealthy[Clusthealthy$Model_1==3,]
Clusthealthy[Clusthealthy$Model_1==4,]
```
```{r}
mean(Clusthealthy[Clusthealthy$Model_1==1,"rating"])
mean(Clusthealthy[Clusthealthy$Model_1==2,"rating"])
mean(Clusthealthy[Clusthealthy$Model_1==3,"rating"])
mean(Clusthealthy[Clusthealthy$Model_1==4,"rating"])

```
# hence we see that mean value of cluster 1 is high (73.84446), we can choose cluster1 

